module.exports = {
  config: {
    name: "mentionCall",
    version: "1.0",
    author: "Omar",
    role: 0,
    shortDescription: "Send a caption to the mentioned user",
    longDescription: "When someone is mentioned, sends a random caption to that user only",
    category: "group"
  },

  onMessage: async function ({ api, event }) {

    // ржпржжрж┐ mention ржирж╛ ржерж╛ржХрзЗ, ржХрж┐ржЫрзБ ржХрж░ржмрзЗ ржирж╛
    if (!event.mentions || Object.keys(event.mentions).length === 0) return;

    const botID = api.getCurrentUserID();

    // рж╢рзБржзрзБржорж╛рждрзНрж░ first mentioned user ржХрзЗ handle ржХрж░ржмрзЗ
    let mentionIDs = Object.keys(event.mentions).filter(id => id !== botID);
    if (mentionIDs.length === 0) return;

    const userID = mentionIDs[0]; // ржкрзНрж░ржержо ржпрж╛ржХрзЗ mention ржжрзЗржУрзЯрж╛ рж╣рзЯрзЗржЫрзЗ
    const userTag = event.mentions[userID];

    const captions = [
      "ЁЯУв ржЖржкржирж╛ржХрзЗ ржбрж╛ржХрж╛ рж╣ржЪрзНржЫрзЗ, ржжрзНрж░рзБржд ржЧрзНрж░рзБржкрзЗ рж╣рж╛ржЬрж┐рж░ рж╣ржи!",
      "ЁЯЪи рж╕ржмрж╛ржЗ ржЖржкржирж╛ржХрзЗ ржЦрзБржБржЬржЫрзЗ, ржкрзНрж▓рж┐ржЬ ржЪрж▓рзЗ ржЖрж╕рзБржи!",
      "ЁЯСА ржХрзЛржерж╛ржпрж╝ ржЖржкржирж┐? ржЖржкржирж╛рж░ ржЕржкрзЗржХрзНрж╖рж╛ржпрж╝ ржЖржЫрж┐!",
      "ЁЯУЮ ржЬрж░рзБрж░рж┐ ржбрж╛ржХ! ржПржЦржиржЗ ржЖрж╕рзБржиред",
      "тП░ рж╕ржоржпрж╝ рж╣ржпрж╝рзЗржЫрзЗ рж╣рж╛ржЬрж┐рж░ рж╣ржУржпрж╝рж╛рж░!",
      "ЁЯФе ржЧрзНрж░рзБржк ржЬржорзЗ ржЧрзЗржЫрзЗ, рж╢рзБржзрзБ ржЖржкржирж╛ржХрзЗржЗ ржжрж░ржХрж╛рж░!",
      "ЁЯТм ржЖрж▓рзЛржЪржирж╛ ржЪрж▓ржЫрзЗ тАФ ржЖржкржирж╛ржХрзЗ ржЫрж╛ржбрж╝рж╛ ржЕрж╕ржорзНржкрзВрж░рзНржг!",
      "тЪб ржжрзНрж░рзБржд ржЖрж╕рзБржи! ржмрж┐рж╢рзЗрж╖ ржбрж╛ржХ ржПрж╕рзЗржЫрзЗ!",
      "ЁЯОп ржЯрж╛рж░рзНржЧрзЗржЯ ржЖржкржирж┐ ЁЯШД ржПржЦржиржЗ рж░рж┐ржкрзЛрж░рзНржЯ ржХрж░рзБржи!",
      "ЁЯУг ржЖржкржирж╛ржХрзЗ ржЕржмрж┐рж▓ржорзНржмрзЗ рж╣рж╛ржЬрж┐рж░ рж╣рждрзЗ ржмрж▓рж╛ рж╣ржЪрзНржЫрзЗ!",
      "ЁЯШО ржЖржкржирж╛ржХрзЗ ржЫрж╛ржбрж╝рж╛ ржЧрзНрж░рзБржкржЯрж╛ ржлрж╛ржБржХрж╛ рж▓рж╛ржЧржЫрзЗ!",
      "ЁЯЪА ржжрзНрж░рзБржд рж▓рзНржпрж╛ржирзНржб ржХрж░рзБржи ржЧрзНрж░рзБржкрзЗ!",
      "ЁЯФФ ржирзЛржЯрж┐ржлрж┐ржХрзЗрж╢ржи: ржЖржкржирж╛рж░ ржЙржкрж╕рзНржерж┐рждрж┐ ржЬрж░рзБрж░рж┐!",
      "ЁЯОЙ рж╕ржмрж╛ржЗ ржЖржЫрзЗ, рж╢рзБржзрзБ ржЖржкржирж┐ ржирж╛ржЗ!",
      "ЁЯЫОя╕П ржЖржкржирж╛рж░ ржЬржирзНржп ржХрж▓ ржПрж╕рзЗржЫрзЗ ЁЯШБ",
      "ЁЯМЯ VIP ржбрж╛ржХ тАФ ржжржпрж╝рж╛ ржХрж░рзЗ ржкрзНрж░ржмрзЗрж╢ ржХрж░рзБржи!",
      "ЁЯУН ржЖржкржирж╛рж░ рж▓рзЛржХрзЗрж╢ржи ржжрж░ржХрж╛рж░ ЁЯШД",
      "ЁЯдЦ рж╕рж┐рж╕рзНржЯрзЗржо ржмрж▓ржЫрзЗ тАФ ржПржЦржиржЗ ржпрзЛржЧ ржжрж┐ржи!",
      "ЁЯе│ ржоржЬрж╛ рж╢рзБрж░рзБ рж╣ржпрж╝рзЗржЫрзЗ, ржЖржкржирж╛ржХрзЗ ржорж┐рж╕ ржХрж░ржЫрж┐!",
      "ЁЯз▓ рж╕ржмрж╛ржЗ ржЯрж╛ржиржЫрзЗ тАФ ржПржЦржи рж╢рзБржзрзБ ржЖржкржирж╛ржХрзЗржЗ ржЪрж╛ржЗ!"
    ];

    const msg = captions[Math.floor(Math.random() * captions.length)];

    // рж╢рзБржзрзБ ржпрзЗ user ржХрзЗ mention ржжрж┐рзЯрзЗржЫрзЗ рждрж╛ржХрзЗ ржкрж╛ржарж╛ржирзЛ рж╣ржЪрзНржЫрзЗ
    return api.sendMessage({
      body: msg,
      mentions: [{
        id: userID,
        tag: userTag
      }]
    }, event.threadID, event.messageID);
  }
};
